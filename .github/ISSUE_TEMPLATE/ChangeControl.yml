name: Change Request
description: Request and track an IT change
title: "CHG: <short descriptive title>"
body:
  - type: markdown
    attributes:
      value: |
        ## Change Request Form
        Provide enough detail for CAB review and audit.  

  - type: input
    id: change_id
    attributes:
      label: Change ID
      description: Automatically generated ID based on creation date and issue number
      placeholder: "YYYYMMDD-<issue-number>"
      value: "{{ date | date: '%Y%m%d' }}-{{ issue.number }}"
    validations:
      required: true

  - type: dropdown
    id: change_type
    attributes:
      label: Change Type
      description: Classify the change
      options:
        - Standard
        - Normal
        - Emergency
    validations:
      required: true

  - type: input
    id: submitted_by
    attributes:
      label: Submitted By
      description: Name/email of the requester
      placeholder: user@example.com
    validations:
      required: true

  - type: input
    id: date_submitted
    attributes:
      label: Date Submitted
      description: ISO 8601 date/time with timezone
      placeholder: "2024-05-12T02:00:00Z"
    validations:
      required: true

  - type: textarea
    id: approvers
    attributes:
      label: Approvers
      description: List roles/names and approval status (e.g., CAB - pending)
      value: |
        - role: CAB
          name: 
          status: pending
          timestamp: 
    validations:
      required: false

  - type: textarea
    id: summary
    attributes:
      label: Summary and Scope
      description: Purpose, scope, and user/business impact of the change
      placeholder: Briefly describe what this change is and why it is needed.
    validations:
      required: true

  - type: dropdown
    id: category
    attributes:
      label: Category
      options:
        - Application
        - Infrastructure
        - Security
        - Database
        - Network
    validations:
      required: true

  - type: dropdown
    id: risk_level
    attributes:
      label: Risk Level
      options:
        - Low
        - Medium
        - High
    validations:
      required: true

  - type: textarea
    id: risk_reason
    attributes:
      label: Risk Reasoning
      description: Justify the selected risk level
      placeholder: Describe impact, blast radius, reversibility.
    validations:
      required: true

  - type: dropdown
    id: priority
    attributes:
      label: Priority
      options:
        - P1
        - P2
        - P3
    validations:
      required: true

  - type: textarea
    id: systems_affected
    attributes:
      label: Systems Affected
      description: Services, hosts, or components impacted
      value: |
        - service: 
          environment: 
    validations:
      required: true

  - type: textarea
    id: change_items
    attributes:
      label: Change Items / Implementation Steps
      description: Ordered list of steps with owners and timing
      value: |
        - order: 1
          owner: 
          action: 
          duration_estimate: 
    validations:
      required: true

  - type: textarea
    id: rollback_plan
    attributes:
      label: Rollback Plan
      description: Step-by-step actions to revert the change
      value: |
        - "Re-deploy previous stable version"
    validations:
      required: true

  - type: textarea
    id: validation_plan
    attributes:
      label: Validation Plan
      description: Pre- and post-change checks with expected outcomes
      value: |
        - check: "Smoke test /health"
          expected: "HTTP 200"
    validations:
      required: true

  - type: textarea
    id: dependencies
    attributes:
      label: Dependencies
      description: Upstream/downstream changes or tickets
      value: |
        - ""
    validations:
      required: false

  - type: textarea
    id: compliance_notes
    attributes:
      label: Compliance Notes
      description: SOX/PCI/HIPAA references if applicable
      value: "N/A"
    validations:
      required: false

  - type: input
    id: planned_start
    attributes:
      label: Planned Start
      description: Scheduled start date/time (include timezone)
      placeholder: "2024-05-12T02:00:00Z"
    validations:
      required: true

  - type: input
    id: planned_end
    attributes:
      label: Planned End
      description: Scheduled end date/time (include timezone)
      placeholder: "2024-05-12T03:00:00Z"
    validations:
      required: true

  - type: input
    id: maintenance_window
    attributes:
      label: Maintenance Window
      description: Standard window or free-form description
      placeholder: "Sun 02:00-03:00 UTC"
    validations:
      required: false

  - type: dropdown
    id: outage_expected
    attributes:
      label: Outage Expected
      options:
        - "Yes"
        - "No"
    validations:
      required: true

  - type: input
    id: outage_duration_estimate
    attributes:
      label: Estimated Outage Duration
      description: If outage is expected, provide duration (e.g., 15m)
    validations:
      required: false

  - type: textarea
    id: stakeholders
    attributes:
      label: Stakeholders
      description: Audiences to notify (e.g., NOC, customer success, SRE)
      value: |
        - ""
    validations:
      required: false

  - type: textarea
    id: notification_plan
    attributes:
      label: Notification Plan
      description: How/when to notify before, during, and after the change
      value: |
        - phase: pre
          message: ""
    validations:
      required: false

  - type: textarea
    id: status_updates
    attributes:
      label: Status Updates
      description: Cadence during the change (e.g., every 30 minutes)
      value: "every 30m"
    validations:
      required: false

  - type: textarea
    id: required_roles
    attributes:
      label: Approvals Required
      description: Roles that must review/approve
      value: |
        - CAB
        - Security
    validations:
      required: false

  - type: textarea
    id: signoffs
    attributes:
      label: Signoffs
      description: Track role, name, status, and timestamp
      value: |
        - role: 
          name: 
          status: pending
          timestamp: 
    validations:
      required: false

  - type: textarea
    id: pre_checks
    attributes:
      label: Pre-Checks
      description: Commands or runbooks to execute before starting
      value: |
        - "Confirm backups within 24h"
    validations:
      required: false

  - type: textarea
    id: post_checks
    attributes:
      label: Post-Checks
      description: Health checks, dashboards, metrics to verify success
      value: |
        - "Verify dashboards show <1% error rate"
    validations:
      required: false

  - type: textarea
    id: attachments
    attributes:
      label: Attachments
      description: Links to diagrams, runbooks, or playbooks
      value: |
        - "Runbook: https://..."
    validations:
      required: false

  - type: textarea
    id: impact_assessment
    attributes:
      label: Impact Assessment
      description: User/business impact and blast radius
      placeholder: Describe expected impact and affected users.
    validations:
      required: true

  - type: textarea
    id: mitigations
    attributes:
      label: Mitigations
      description: Guardrails, feature flags, canary scope, rate limits
      value: |
        - "Enable canary to 5% traffic"
    validations:
      required: false

  - type: textarea
    id: monitoring
    attributes:
      label: Monitoring Plan
      description: Dashboards/alerts to watch during/after the change
      value: |
        - "Grafana dashboard: prod/api"
    validations:
      required: false

  - type: textarea
    id: change_log
    attributes:
      label: Change Log
      description: Timestamps for start/stop/pauses and key events
      value: |
        - timestamp: 
          event: 
    validations:
      required: false

  - type: textarea
    id: evidence
    attributes:
      label: Evidence
      description: Links to logs/screenshots supporting completion
      value: |
        - ""
    validations:
      required: false

  - type: textarea
    id: lessons_learned
    attributes:
      label: Lessons Learned
      description: Post-change notes and follow-ups
      value: "N/A"
    validations:
      required: false
